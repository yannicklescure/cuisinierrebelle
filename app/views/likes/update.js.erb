liked = document.querySelector("[data-like-recipe='<%= @recipe.id %>']");
faHeart = document.querySelector(".fa-heart-<%= @recipe.id %>");

likes_count = `<span class="text-muted font-weight-lighter ml-1"><%= @recipe.likes.count %></span>`;
heart = `<i class="material-icons md-18 align-icons">favorite_border</i>`;
heartFill = `<i class="material-icons md-18 align-icons">favorite</i>`;

<% @comment_id = @comment.nil? ? 0 : @comment.id %>
commentLikes = document.querySelector('#comment-<%= @comment_id %>-likes');
if (commentLikes) commentLikes.innerHTML = <%= @comment.nil? ? 0 : @comment.comment_likes.count %>;


<% @reply_id = @reply.nil? ? 0 : @reply.id %>
replyLikes = document.querySelector('#reply-<%= @reply_id %>-likes');
if (replyLikes) replyLikes.innerHTML = <%= @reply.nil? ? 0 : @reply.reply_likes.count %>;

fade = (element) => {
    var op = 1;  // initial opacity
    var timer = setInterval(function () {
        if (op <= 0.1){
          clearInterval(timer);
          element.style.display = 'none';
        }
        element.style.opacity = op;
        element.style.filter = 'alpha(opacity=' + op * 100 + ")";
        op -= op * 0.1;
    }, 50);
}

unfade = (element) => {
    var op = 0.1;  // initial opacity
    element.style.display = 'block';
    var timer = setInterval(function () {
        if (op >= 1){
            clearInterval(timer);
        }
        element.style.opacity = op;
        element.style.filter = 'alpha(opacity=' + op * 100 + ")";
        op += op * 0.1;
    }, 10);
}

if(<%= @liked %>) {
  if (liked) liked.innerHTML = `${heartFill}${likes_count}`;
  if(faHeart != null) {
    faHeart.classList.remove('d-none');
    unfade(faHeart);
    setTimeout(() => {
      fade(faHeart);
      setTimeout(() => {faHeart.classList.add('d-none')}, 500);
    }, 500);
  }
} else {
  liked.innerHTML = `${heart}${likes_count}`;
}
